define("nowcoder/1.2.1280/javascripts/site/ta/question/index",["nc","cpn","ncpc","../../../core/siteConfig","../../../util/littleAction","../../../action/contest","../../../action/note","../../../action/question","../../../component/share","../../../action/share","./module/menu"],function(t,e,i){var a,d,o=t("nc"),n=t("cpn"),r=t("ncpc"),g=o.$,s=o.Db,m=o.Event,u=o.DragDrop,l=o.Str,c=o.Sys,v=o.Base,h=o.Uri,p=o.Dom,f=o.Sound,E=o.CodeLang,w=o.MathJax,C=n.Popup,I=r.Env,x=r.Code,j=r.Util,y=r.PopupCommon,T=t("../../../core/siteConfig"),b=t("../../../util/littleAction"),q=t("../../../action/question"),H=t("../../../component/share"),k=t("./module/menu"),S="data-drag",A=new f("//uploadfiles.nowcoder.com/acts/acm_pass.wav");c.ready({initialize:function z(){var e=this;j.getEditor(["codeEditor","codeFEEditor"],function(t){a=t.codeEditor,d=t.codeFEEditor,e.initData(),e.initUi(),e.initFold(),e.initSubmitMode(),e.initAction(),e.initEditor(),e.initResize(),k.init(e),e.initDragDrop(),e.initDragSplit(),w.image(g(".js-left"))})},initData:function D(){var t=this;t.resultEl=g(".js-right-bottom"),v.copy(t,window,["pageInfo"]),t.uuid=t.pageInfo.uuid||"",t.nextTqId=+t.pageInfo.nextTqId||0,t.nextTqUuid=t.pageInfo.nextTqUuid||"",t.tPage=+t.pageInfo.tPage||0,t.tpId=+t.pageInfo.tpId||0,t.topicTitle=t.pageInfo.topicTitle||"",t.isNeedSimilar=13===t.tpId||46===t.tpId},initUi:function M(){"0"===this.pageInfo.codeJudgeType&&g(".js-nk-warning").show()},initFold:function R(){var o=this;g(document).on("click",".js-fold",function(t){var e=g(t.currentTarget),i=e.find("a");o.openTab(i.hasClass("icon-angle-up"))})},initSubmitMode:function F(){var o=this,t=g(".js-sumit-type");if(0===t.length)return;var i=t.find(".nk-checkbox-toggle[data-type=0] input"),n=t.find(".nk-checkbox-toggle[data-type=1] input");function a(){var t=o.codeEditor,e=o.valExamMode();i.prop("checked",!e),n.prop("checked",e),t&&v.extend(t.rawConfig.statusExtParam,{isContestExercise:e?"true":undefined})}t.show(),a(),t.on("click",".nk-checkbox-toggle",function(t){t.preventDefault();var e=g(t.currentTarget),i="1"===g.trim(e.attr("data-type"));o.valExamMode(i),a()})},initAction:function P(){var t=this.pageInfo.questionId,e=T.type.problem;x.onlineJudgeHelp({el:g("a.js-coding-help")});var i=g(".js-question-content").text(),o=H.show({target:g(".js-call-help"),btn:["img","wx","qq","weibo","link"],title:"「求助大佬帮看看这道算法题吧！」",desc:H.fixContent(i),link:window.location.origin+"/questionTerminal/"+this.pageInfo.uuid,shareType:T.share.contest,entityId:t,attach:{verReverse:!0,extOffset:{top:10}}}),n=g(".code-help-pop");o.tips.getEl().hover(function(t){n.show()},function(t){n.css("display","")}),b.correction({el:g("a.click-correction"),entityId:t,entityType:e}),b.follow({followCls:"js-click-follow",unfollowCls:"js-click-unfollow",followStr:"收藏",entityId:t,entityType:e}),b.note({editCls:["js-add-note"],foldCls:["fold-notes","show-all-notes"],delCls:["js-del-note"],entityId:t,entityType:e,defaultTilte:g.trim(g(".js-question-title").text()),ok:function(){C.tips("操作成功")}})},initResize:function L(){var i=this,e=g(window),a=g("div.nk-main"),n=a.find("div.js-topic-similar"),d=a.find("div.js-topic-menu"),r=d.find("div.terminal-topic-wrap"),s=d.find(".js-list"),l=a.find(".js-left"),o=a.find(".js-right"),c=o.children(),u=o.find("#jsCodeEditor"),h=l.find(".full-separator");function t(){if(!i.codeEditor||!i.codeEditor.isFullScreen){a.outerHeight(e.height()).outerWidth(e.width()),l.addClass("code-body-hidden"),o.addClass("code-body-hidden");var t=a.height();p(t),function n(t){t=t||a.height(),l.outerHeight(t),t=l.height();var e=l.find(".terminal-topic-wrap").outerHeight();l.find("div.terminal-topic").outerHeight(t-e).css("overflow-y","auto");var i=l.find("div.terminal-topic"),o=l.find(".terminal-topic-wrap");i.width(o.outerWidth()-30),l.find("div.terminal-topic .oprt-tool").outerWidth(o.outerWidth()),h.css("right",0).css("left","auto").height(i.height()).css("top",e)}(t),f(t)}}function p(t){var e=s.scrollTop();t=t||a.height(),d.outerHeight(t),n.outerHeight(t);var i=s.height("auto").outerHeight(),o=r.outerHeight();s.outerHeight(i+t-o),s.scrollTop(e)}function f(t){t=t||a.height(),o.outerHeight(t),t=o.height();var e=0;v.forEach(c,function(t){"none"!==(t=g(t)).css("display")&&t.get(0)!==u.get(0)&&(e+=t.outerHeight())}),u.outerHeight(Math.max(100,t-e)),i.codeEditor&&i.codeEditor.resize(null,u.height()),i.resultEl.outerWidth(o.width()).outerHeight(Math.max(60,.2*t)),g("#jsRunInfo").outerHeight(i.resultEl.height())}g(document.body).addClass("code-body-hidden"),e.on("resize",function(){window.setTimeout(t,50)}),m.listen("resizeAll",t),m.listen("resizeMenu",p),m.listen("resizeRight",f),t()},initEditor:function U(){var o=this,n=o.pageInfo;if(o.isFront())var t=x.initFECodeEditor(d,{noAutoSize:!0,autoFixHeight:!0,questionId:n.questionId,supportLang:n.supportLang,langTpl:E.getTplFE(),codeEl:g("#jsCodeEditor"),runInfoEl:g("#jsRunInfo"),runCodeEl:g("#jsRunCode"),loadCodeEl:g("#jsLoadCode"),loadAcceptCodeEl:g("#jsLoadAcceptCode")});else var t=x.initCodeEditor(a,{noAutoSize:!0,autoFixHeight:!0,questionId:n.questionId,subTagId:(window.codingInfo||{}).subTagId,codeJudgeType:n.codeJudgeType,selfTestSystemCase:E.getExample(),runExtParam:{tagId:h.getParam("tagId"),doneQuestionId:h.getParam("ACMContestId")},statusExtParam:{isContestExercise:o.valExamMode()?"true":undefined},langTpl:E.getTpl(),codeEl:g("#jsCodeEditor"),runInfoEl:g("#jsRunInfo"),runCodeEl:g("#jsRunCode"),loadCodeEl:g("#jsLoadCode"),loadAcceptCodeEl:g("#jsLoadAcceptCode")});t.listen("beforeRunCode",function(){o.openTab()}),t.listen("fullScreen",function(t){!t&&m.fire("resizeAll")}),t.listen("runCodeSuccess",function(t){var e=h.getParams();e.tqId=n.nextTqId;var i=0<n.nextTqId?h.addParam(e,"/practice/"+n.nextTqUuid):"";A.play(),o.showAc(t,i)}),t.showResult=function(t,e,i){var o=this.rawConfig,n=o.tipEl;if(!(t=g.trim(t)))return n.html("").hide();n.css("color",!0===e?"#b6b79a":"#00bc9b");var a=i?"<div>自测结果</div>":"";a+=!1===e?'<div class="ico-passed">通过</div>':!0===e?'<div class="ico-unpass">不通过</div>':"",a+="<div>"+t.replace(/\n/g,"<br />")+"</div>",n.html(a)},o.codeEditor=t},initDragDrop:function _(){var d=this,t=g(".js-fold"),r=d.resultEl,s=g(".js-right"),l=s.find("#jsCodeEditor"),c=s.children(),e=t.find("a");function i(){return!(e.hasClass("icon-angle-up")||d.codeEditor&&d.codeEditor.isFullScreen)}new u({drag:t,listeners:[{name:"start",handler:function(){i()&&(this._bottomHeight=r.outerHeight(),t.attr(S,"1"))}},{name:"drag",handler:function(){if(i()){var t=this._downY-this._moveY;!function a(t,e){var i=s.height(),t=Math.max(60,t+e),o=0;v.forEach(c,function(t){(t=g(t)).get(0)!==l.get(0)&&t.get(0)!==r.get(0)&&(o+=t.outerHeight())});var n=i-o-t;n<100&&(t=i-o-(n=100));l.outerHeight(n),d.codeEditor&&d.codeEditor.resize(null,l.height()),r.outerHeight(t),g("#jsRunInfo").outerHeight(d.resultEl.height())}(this._bottomHeight,t)}}},{name:"drop",handler:function(){i()&&(this._bottomHeight=null,window.setTimeout(function(){t.removeAttr(S)},0))}}]})},initDragSplit:function J(){var e,i,t=g(".full-separator"),o=g("div.nk-main"),n=o.find(".js-left"),a=o.find(".js-right");new u({drag:t,listeners:[{name:"start",handler:function(){this.offset=t.offset(),e=n.width(),i=a.width()}},{name:"drag",handler:function(){var t=this._moveX-this._downX;n.width()<=250&&t<0||a.width()<=550&&0<t||(n.width(e+t),a.width(i-t),a.css("marginLeft",e+t),m.fire("resizeAll"))}},{name:"drop",handler:function(){this.offset=null}}]})},openTab:function W(t){var e=g(".js-fold");t=!1!==t,"1"!==e.attr(S)&&(p.cls(e.find("a"),{"icon-angle-down":t,"icon-angle-up":!t}),this.resultEl[t?"show":"hide"](),e.css("cursor",t?"ns-resize":"pointer"),m.fire("resizeRight"))},isFront:function N(){return"2"===v.id(this.pageInfo.codeJudgeType)},showAc:function X(t,e){t=t||{};var i=this.pageInfo,n=y.ac({seconds:t.seconds,memory:t.memory,uuid:i.uuid,answerUrl:"/questionTerminal/"+i.uuid,nextUrl:e});I.isLogin()&&this.isNeedSimilar&&q.getSimCompanyList({query:{uuid:i.uuid,maxShowCount:3},call:function(t){var e=t.data||[];if(!(e.length<=0)){var i=v.map(e,function(t){var e=t.qstatus;return l.execTpl(["<dd>",'<a href="/practice/#{uuid}" data-href="/practice/#{uuid}" data-paper="/test/#{paperId}/summary" target="_blank">',{0:'<i class="icon-lock"></i>',1:'<i class="icon-spot-green"></i>',2:'<i class="icon-spot-red"></i>'}[e]||'<i class="icon-spot-gray"></i>','<span class="pop-test-txt">#{questionTitle}</span>','<span class="pop-exam-txt">#{paperName}</span>','<span class="pop-exam-tag js-paper-btn">查看试卷</span>','<span class="pop-exam-level-txt">#{difficult}</span>',"</a>","</dd>"].join(""),t)}).join(""),o=g('<dl class="pop-challenge-test"><dt>你可以挑战相似的企业真题巩固知识</dt>'+i+"</dl>");n.getEl(".layer-share-wrapper").after(o),n.fixPosition(),v.forEach(o.find("dd a"),function(t){t=g(t);var e=g.trim(t.attr("data-href")),i=g.trim(t.attr("data-paper")),o=t.find(".js-paper-btn");p.hover(o,function(){t.attr("href",i)},function(){t.attr("href",e)})})}}})},valExamMode:function Y(t){var e="taSubmitExamMode";if(0===arguments.length)return"1"===s.get(e);t&&s.set(e,"1"),!t&&s.remove(e)}})});
define("nowcoder/1.2.1280/javascripts/site/ta/question/module/menu",["nc","cpn","ncpc","../../../../action/question"],function(i,t,e){var n=i("nc"),s=(i("cpn"),i("ncpc")),r=n.$,c=n.Base,p=(n.Clazz,n.Dom),u=n.Str,d=n.Uri,f=n.Event,a=s.Env,o=i("../../../../action/question");e.exports={init:function l(i){var t=this;t.initData(i);var e=t.info.tpId;e&&"0"!==e&&t.initMenu(),a.isLogin()&&t.isNeedSimilar&&t.initSimilar()},initData:function m(i){var t=this;t.info=i.pageInfo,t.isNeedSimilar=i.isNeedSimilar,t.titleEl=r("div.js-topic-title"),t.menuEl=r("div.js-topic-menu"),t.listEl=t.menuEl.find(".js-list"),t.tipsEl=t.listEl.find("div.js-list-tips"),t.ulListEl=t.listEl.find("div.js-ul-list")},initMenu:function g(){var e,n,s=this,i=s.info,t=+i.tPage||1,a=s.menuEl,l=s.titleEl;function o(i,t){p.hover(i,function(i){clearTimeout(e),clearTimeout(n),!t&&r(),t&&(n=window.setTimeout(function(){!s.isHoverSimilar&&!s.isShowSimilar&&r()},100))},function(){clearTimeout(e),clearTimeout(n),e=window.setTimeout(c.bind(a.hide,a),200)})}function r(){a.slideDown(200,function(){f.fire("resizeMenu")}),s.isFirstHover&&s.getListItems({page:i.tPage}),s.isFirstHover=!1}s.isFirstHover=!0,s.isFirstPage=!0,s.prePage=t,s.nextPage=t,o(l,!0),o(a)},initSimilar:function v(){var s=this,a=s.titleEl,l=r(".js-topic-similar");o.getSimCompanyList({query:{uuid:s.info.uuid,maxShowCount:10},call:function(i){var t=i.data||[];t.length<=0||(!function n(i){var t=l.find("dl.pop-challenge-test"),e=c.map(i,function(i){var t=i.qstatus;return u.execTpl(["<dd>",'<a href="/practice/#{uuid}" data-href="/practice/#{uuid}" data-paper="/test/#{paperId}/summary" target="_blank">',{0:'<i class="icon-lock"></i>',1:'<i class="icon-spot-green"></i>',2:'<i class="icon-spot-red"></i>'}[t]||'<i class="icon-spot-gray"></i>','<span class="pop-test-txt">#{questionTitle}</span>','<span class="pop-exam-txt">#{paperName}</span>','<span class="pop-exam-tag js-paper-btn">查看试卷</span>','<span class="pop-exam-level-txt">#{difficult}</span>',"</a>","</dd>"].join(""),i)}).join("");t.html(e),c.forEach(t.find("dd a"),function(i){i=r(i);var t=r.trim(i.attr("data-href")),e=r.trim(i.attr("data-paper")),n=i.find(".js-paper-btn");p.hover(n,function(){i.attr("href",e)},function(){i.attr("href",t)})})}(t),function e(){var i=s.similarBtn=r('<a href="javascript:void(0);" class="float-right link-white"><i class="icon-nc-similar"></i> 相似的企业真题</a>');a.find(".js-question-title").append(i),p.hover(i,function(){s.isHoverSimilar=!0},function(){s.isHoverSimilar=!1}),i.on("click",function(){s.isShowSimilar=!0,l.slideDown(200,function(){f.fire("resizeMenu")})}),l.on("click",".js-close-popup",function(){s.isShowSimilar=!1,l.hide()})}())}})},getListItems:function h(n){var s=this,a=+n.page||1,l=!!n.pre,i=s.info;a=+a||1,o.getTaQuestionList({query:{tpId:i.tpId,page:a},call:function(i){var t=i.data,e=s.ulListEl;s.renderList(t.data,a,l),a===s.prePage&&(e.find(".js-pre-tips").remove(),t.hasPre?(s.prePage=a-1,e.prepend('<div class="js-pre-tips" style="text-align:center;">加载中...</div>')):(s.prePage=null,s.topCancelCb&&s.topCancelCb()),s.isReqPre=!1),a===s.nextPage&&(e.find(".js-next-tips").remove(),t.hasNext?(s.nextPage=a+1,e.append('<div class="js-next-tips" style="text-align:center;">加载中...</div>')):(s.nextPage=null,s.bottomCancelCb&&s.bottomCancelCb()),s.isReqNext=!1),s.isFirstPage&&window.setTimeout(c.bind(s.scrollList,s),1e3),s.isFirstPage=!1,n.call&&n.call(t)},error:function(i){s.isFirstPage&&(s.tipsEl.html(i.msg),s.isFirstHover=!0)}})},scrollList:function x(){var i=this,t=i.listEl,e=i.ulListEl;window.setTimeout(function(){i.topCancelCb=p.scrollTop(30,t,function(t){!i.isReqPre&&i.prePage&&i.getListItems({page:i.prePage,pre:!0,call:function(i){i.hasPre&&t&&t()}}),i.isReqPre=!0})},2e3),i.bottomCancelCb=p.scrollBottom(30,t,e,function(t){!i.isReqNext&&i.nextPage&&i.getListItems({page:i.nextPage,pre:!1,call:function(i){i.hasNext&&t&&t()}}),i.isReqNext=!0})},renderList:function P(i,s,t){var a=this,e=r('<ul class="js-page-'+s+'"></ul>'),l="",o=d.getParams();c.forEach(i,function(i){var t=i.qstatus,e=window.location.pathname.split("/");e[e.length-1]=i.quuid,o.tqId=i.tqId,o.tPage=s;var n=d.addParam(o,e.join("/"));l+=u.execTpl(['<li class="#{liCls}">','<a class="topic-title-txt" href="#{href}">#{title}</a>','<span class="#{cls}"></span>',"</li>"].join(""),{title:i.qtitle,liCls:i.quuid===a.info.uuid?"active":"",cls:0===t?"icon-lock":1===t?"green-spot":"red-spot",href:n})}),a.tipsEl.hide(),e.html(l);var n=a.listEl.scrollTop();a.ulListEl[t?"prepend":"append"](e),n+=e.outerHeight(),f.fire("resizeMenu"),t&&a.listEl.scrollTop(n)}}});